
<co-recoverdatalayout [extend]="dataExcel.length > 0" label="PASO 2 DE 3">
    <section class="action-table" view>
        <p-scrollPanel [style]="{height: '100%'}" >
            <div class="p-3">
                <p-table 
                [paginator]="true" [rows]="30" styleClass="p-datatable-sm" responsiveLayout="scroll" [value]="computeTableStudent()"
                [showCurrentPageReport]="true"
                currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} estudiantes"
                >
                    <ng-template pTemplate="header">
                        <tr>
                            <th *ngFor="let item of dataHeaders | keyvalue" [pSortableColumn]="item.key + ''">
                                {{item.value}}
                                <p-sortIcon [field]="item.key + ''"></p-sortIcon>
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-student>
                        <tr>
                            <td>{{student.career}}</td>
                            <td>{{student.careerName}}</td>
                            <td>{{student.code}}</td>
                            <td>{{student.dni}}</td>
                            <td>{{student.fullname}}</td>
                            <td>{{student.group}}</td>
                            <td>{{student.modality}}</td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
        </p-scrollPanel>
        
        <div style="padding: 1rem;">
            <h3 class="mb-2">Cabeceras encontradas</h3>
            <div style="display: flex; gap: .25rem;flex-wrap: wrap;" >
                <p-chip *ngFor="let header of keyHeaders" [label]="header" [style]="{background: 'var(--primary-color)', height: '28px', color: 'white'}"></p-chip>
            </div>
            <h3 class="mb-2 mt-4">Cabeceras enlazadas</h3>
            <div style="display: grid; grid-template-columns: auto 1fr auto; gap: .25rem; align-items: center;">
                <p-chip [label]="'header'" [style]="{background: 'var(--primary-color)', height: '28px', color: 'white'}"></p-chip>
                <div style="height: 1
                px; background-color: white; width: auto;"></div>
                <p-chip [label]="'header'" [style]="{background: 'var(--primary-color)', height: '28px', color: 'white'}"></p-chip>
            </div>
        </div>
    </section>
    <div action class="f-c" style="height: 100%;">
        <img src="/assets/microsoft-excel.svg" style="height: 6rem;">
        <co-box size="2rem"></co-box>
        <h3>Seleccione su archivo Excel con los datos de alumnos</h3>
        <co-box></co-box>
        <label pButton>Cargar Excel Alumnos
            <input type="file" accept=".xlsx,.xls" style="display: none;" (change)="readExcel($event)">
        </label>
    </div>
</co-recoverdatalayout>